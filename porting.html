<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CIMUnit: Porting CIMUnit to a New Operating System</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CIMUnit&#160;<span id="projectnumber">1.0</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Porting CIMUnit to a New Operating System </div>  </div>
</div>
<div class="contents">
<div class="textblock"><p>CIMUnit was designed to be portable between operating systems, and the effort of porting CIMUnit is limited to a small amount of code. Since C/C++ doesn't specify a particular threading model it isn't possible to write CIMUnit in code that is portable between operating systems. Pthreads, for instance, is supported on many operating Unix-like operating systems and partially or fully supported on some embedded operating systems and Windows. Because of the wide availability of pthreads, it could have been considered a standard and the project may have been locked into it. However, pthreads isn't a native part of Windows and its use in embedded operating systems may preclude the use of native tasking models. Therefore, the project decided to pursue a route where operating system specific concepts were encapsulated. This simplifies the porting of CIMUnit by requiring a developer to reimplement a few well defined software components.</p>
<h2><a class="anchor" id="port_build"></a>
Build Environment</h2>
<p>The build environment for the CIMUnit library requires the following:</p>
<ul>
<li>Bison version 2.4.1 or higher</li>
<li>Flex version 2.5.33 or higher</li>
</ul>
<p>For Windows 2k, XP and Server 2003, Microsoft has ported Bison and Flex and has packed them in their Windows Services for UNIX 3.5 download. Windows 7 apparently has a Windows Services for UNIX component that is available to install on the Enterprise or Ultimate versions.</p>
<p>The CMake build files may need to be updated, or a new build system implemented.</p>
<p>An operating system dependant #define must be created for each operating system and named as follows PLATFORM_{operating system}. This #define must be defined for each file built as part of the CIMUnit library and by all files that include <a class="el" href="cimunit_8h.html">cimunit.h</a>. This is typically passed as a command line parameter to the compiler such as -D.</p>
<h2><a class="anchor" id="port_headers"></a>
Header File Updates</h2>
<p>The following header files must be updated to point to the operating system specific varient of the header file. The variant header file name should be cimunit_{module}_{operating system}.h:</p>
<ul>
<li><a class="el" href="cimunit__barrier_8h.html">cimunit_barrier.h</a></li>
<li><a class="el" href="cimunit__platform_8h.html">cimunit_platform.h</a></li>
<li><a class="el" href="cimunit__mutex_8h.html">cimunit_mutex.h</a></li>
<li><a class="el" href="cimunit__thread_8h.html">cimunit_thread.h</a></li>
</ul>
<p>Compiler / operating system specific #defines must be created as specified below. The #defines must be placed in cimunit_platform_{operating system}.h:</p>
<ul>
<li>RESTRICT<ul>
<li>C99 keyword, not universally supported.</li>
<li>It may be left blank or defined as __restruct depending on the capabilities of the compiler.</li>
</ul>
</li>
<li>BOOL<ul>
<li>May be defined to bool, or int as supported by the compiler.</li>
</ul>
</li>
<li>TRUE<ul>
<li>May be defined to true, or 1 or a compiler header file that define TRUE may be included.</li>
</ul>
</li>
<li>FALSE<ul>
<li>May be defined to false, or 0 or a compiler header file that define FALSE may be included.</li>
</ul>
</li>
<li>CIMUNIT_DEFAULT_THEAD_NAME<ul>
<li>Specifies what the operating system specific default is for a thread that isn't named.</li>
</ul>
</li>
<li>CIMUNIT_MAX_THREAD_NAME_LENGTH<ul>
<li>Specifies what the maximum length of a thread name can be. This is used to allocate sufficent memory to copy the name of the thread.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="port_code"></a>
Writing Operating Specific Support Modules</h2>
<p>The operating system capabilities that were abstracted and need to be reimplemented for each operating system are defined below. See the documentation under each component to determine how to implement it for the new operating system:</p>
<ul>
<li><a class="el" href="group__cimunit__barrier.html">cimunit_barrier Module</a></li>
<li><a class="el" href="group__cimunit__mutex.html">cimunit_mutex Module</a></li>
<li><a class="el" href="group__cimunit__thread.html">cimunit_thread Module</a></li>
</ul>
<h2><a class="anchor" id="port_new"></a>
New Operating System Specific Files</h2>
<p>When porting CIMUnit to an operating system that natively supports named threads, and where the named thread capability is intended to be used, some extra modifications will be required. The changes will be to create operating system specific variants of the <a class="el" href="cimunit__thread__table_8c.html">cimunit_thread_table.c</a> and <a class="el" href="cimunit__thread__table_8h.html">cimunit_thread_table.h</a> files. </p>
</div></div>


<hr class="footer"/><address class="footer"><small>
Generated for CIMUnit by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4</small></address>

</body>
</html>
